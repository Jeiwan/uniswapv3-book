<h1 id="erc721-overview">ERC721 Overview</h1>

<p>Let’s begin with an overview of <a href="https://eips.ethereum.org/EIPS/eip-721">EIP-721</a>, the standard that defines NFT
contracts.</p>

<p>ERC721 is a variant of ERC20. The main difference between them is that ERC721 tokens are <em>non-fungible</em>, that is: one
token is not identical to another. To distinguish ERC721 tokens, each of them has a unique ID, which is almost always
the counter at which a token was minted. ERC721 tokens also have an extended concept of ownership: owner of each token
is tracked and stored in the contract. This means that only distinct tokens, identified by token IDs, can be transferred
(or approved for transfer).</p>

<p>Unique identity is what NFT tokens and Uniswap V3 liquidity positions have in common: each NFT token is identified by its
unique ID and each liquidity position is identified by an ID (which is computed from position owner address and the price
range). It’s this similarity that will allow us to integrate the two concepts.</p>

<p>The biggest difference between ERC20 and ERC721 is the <code class="language-plaintext highlighter-rouge">tokenURI</code> function in the latter. NFT tokens, which are
implemented as ERC721 smart contracts, have linked assets that are stored externally, not on blockchain. To link token IDs to
images (or sounds, or anything else) stored outside of blockchain, ERC721 defines the <code class="language-plaintext highlighter-rouge">tokenURI</code> function. The function
is expected to return a link to a JSON file that defines NFT token metadata, e.g.:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thor's hammer"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mjölnir, the legendary hammer of the Norse god of thunder."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://game.example/item-id-8u5h2m.png"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"strength"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>(This example is taken from the <a href="https://docs.openzeppelin.com/contracts/4.x/erc721">ERC721 documentation on OpenZeppelin</a>)</p>

<p>Such JSON file defines: name of a token, description of a collection, link to the image of a token, properties of a
token.</p>

<p>Optionally, we can store JSON metadata files and token images on-chain. We don’t actually need to store full JSON files
for each of the token in a collection because we can simply generate them on-the-fly (when <code class="language-plaintext highlighter-rouge">tokenURI</code> is called) and
fill the fields with token-specific data. The same is true if we use SVG for token images: we can store an SVG template
on-chain and generate token-specific SVG when <code class="language-plaintext highlighter-rouge">tokenURI</code> is called. To store JSON and SVG on-chain, we can use the <a href="https://en.wikipedia.org/wiki/Data_URI_scheme#Syntax">data URI scheme</a>
(and this is what we’ll do!).</p>
