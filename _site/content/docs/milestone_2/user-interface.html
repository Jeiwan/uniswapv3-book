<h1 id="user-interface">User Interface</h1>

<p>Let’s make our web app work more like a real DEX. We can now remove hardcoded swap amounts and let users type arbitrary
amounts. Moreover, we can now let users swap in the both direction, so we also need a button to swap the token inputs.
After updating, the swap form will look like:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">SwapForm</span><span class="dl">"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">SwapInput</span>
    <span class="nx">amount</span><span class="o">=</span><span class="p">{</span><span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">amount0</span> <span class="p">:</span> <span class="nx">amount1</span><span class="p">}</span>
    <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">enabled</span> <span class="o">||</span> <span class="nx">loading</span><span class="p">}</span>
    <span class="nx">readOnly</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span>
    <span class="nx">setAmount</span><span class="o">=</span><span class="p">{</span><span class="nx">setAmount_</span><span class="p">(</span><span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">setAmount0</span> <span class="p">:</span> <span class="nx">setAmount1</span><span class="p">,</span> <span class="nx">zeroForOne</span><span class="p">)}</span>
    <span class="nx">token</span><span class="o">=</span><span class="p">{</span><span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="sr">/</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">ChangeDirectionButton</span> <span class="nx">zeroForOne</span><span class="o">=</span><span class="p">{</span><span class="nx">zeroForOne</span><span class="p">}</span> <span class="nx">setZeroForOne</span><span class="o">=</span><span class="p">{</span><span class="nx">setZeroForOne</span><span class="p">}</span> <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">enabled</span> <span class="o">||</span> <span class="nx">loading</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">SwapInput</span>
    <span class="nx">amount</span><span class="o">=</span><span class="p">{</span><span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">amount1</span> <span class="p">:</span> <span class="nx">amount0</span><span class="p">}</span>
    <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">enabled</span> <span class="o">||</span> <span class="nx">loading</span><span class="p">}</span>
    <span class="nx">readOnly</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
    <span class="nx">token</span><span class="o">=</span><span class="p">{</span><span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="sr">/</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="dl">'</span><span class="s1">swap</span><span class="dl">'</span> <span class="nx">disabled</span><span class="o">=</span><span class="p">{</span><span class="o">!</span><span class="nx">enabled</span> <span class="o">||</span> <span class="nx">loading</span><span class="p">}</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">swap_</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Swap</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span></code></pre></div></div>

<p>Each input has an amount assigned to it depending on swap direction controlled by <code class="language-plaintext highlighter-rouge">zeroForOne</code> state variable. The lower
input field is always read-only because its value is calculated by Quoter contract.</p>

<p><code class="language-plaintext highlighter-rouge">setAmount_</code> function does two things: it updates the value of the top input and calls Quoter contract to calculate the
value of the lower input:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">updateAmountOut</span> <span class="o">=</span> <span class="nx">debounce</span><span class="p">((</span><span class="nx">amount</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">amount</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">amount</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">setLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

  <span class="nx">quoter</span><span class="p">.</span><span class="nx">callStatic</span>
    <span class="p">.</span><span class="nx">quote</span><span class="p">({</span> <span class="na">pool</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">poolAddress</span><span class="p">,</span> <span class="na">amountIn</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">amount</span><span class="p">),</span> <span class="na">zeroForOne</span><span class="p">:</span> <span class="nx">zeroForOne</span> <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">amountOut</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">setAmount1</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">amountOut</span><span class="p">))</span> <span class="p">:</span> <span class="nx">setAmount0</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">amountOut</span><span class="p">));</span>
      <span class="nx">setLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">zeroForOne</span> <span class="p">?</span> <span class="nx">setAmount1</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="nx">setAmount0</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="nx">setLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="kd">const</span> <span class="nx">setAmount_</span> <span class="o">=</span> <span class="p">(</span><span class="nx">setAmountFn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">amount</span> <span class="o">=</span> <span class="nx">amount</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">setAmountFn</span><span class="p">(</span><span class="nx">amount</span><span class="p">);</span>
    <span class="nx">updateAmountOut</span><span class="p">(</span><span class="nx">amount</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Notice the <code class="language-plaintext highlighter-rouge">callStatic</code> called on <code class="language-plaintext highlighter-rouge">quoter</code>–this is what we discussed in a previous chapter. We need to force ethers.js
to make a static call. Since <code class="language-plaintext highlighter-rouge">quote</code> doesn’t have a <code class="language-plaintext highlighter-rouge">pure</code> or <code class="language-plaintext highlighter-rouge">view</code> restriction, ethers.js will try to call <code class="language-plaintext highlighter-rouge">quote</code> in
a transaction.</p>

<p>And that’s it! The UI now allows to specify arbitrary amounts and swap in either direction!</p>
